#include "main.h"

void LCD_Init(void)
{
	HAL_Delay(20);
	LCD_WriteMode();
	LCD_write4bits(0x03);
	HAL_Delay(5);
	LCD_write4bits(0x03);
	LCD_write4bits(0x03);
	LCD_write4bits(0x02);
}

void LCD_Mode(u_int8_t rs, u_int8_t rw)
{
	// choix du mode  write = 10  read = 11

	HAL_GPIO_WritePin(screen_rs_GPIO_Port, screen_rs_Pin, rs);
	HAL_GPIO_WritePin(screen_r_w_GPIO_Port, screen_r_w_Pin_Pin, rw);

	return;
}

void LCD_WriteMode(void)
{
	HAL_GPIO_WritePin(screen_rs_GPIO_Port, screen_rs_Pin, GPIO_PIN_SET);
	HAL_GPIO_WritePin(screen_r_w_GPIO_Port, screen_r_w_Pin_Pin, GPIO_PIN_RESET);

	return;
}

void LCD_write4bits(u_int8_t data)
{
	HAL_GPIO_WritePin(screen_d4_GPIO_Port, screen_d4_Pin, (data & 0x01) ? GPIO_PIN_SET : GPIO_PIN_RESET);
	HAL_GPIO_WritePin(screen_d5_GPIO_Port, screen_d5_Pin, (data & 0x02) ? GPIO_PIN_SET : GPIO_PIN_RESET);
	HAL_GPIO_WritePin(screen_d6_GPIO_Port, screen_d6_Pin, (data & 0x04) ? GPIO_PIN_SET : GPIO_PIN_RESET);
	HAL_GPIO_WritePin(screen_d7_GPIO_Port, screen_d7_Pin, (data & 0x08) ? GPIO_PIN_SET : GPIO_PIN_RESET);

	HAL_GPIO_WritePin(screen_en_GPIO_Port, screen_en_Pin, GPIO_PIN_SET);
	HAL_Delay(1);
	HAL_GPIO_WritePin(screen_en_GPIO_Port, screen_en_Pin, GPIO_PIN_RESET);
	HAL_Delay(1);

	return;
}

void LCD_command(u_int8_t data)
{

	LCD_write4bits(data >> 4);
	LCD_write4bits(data);
}
